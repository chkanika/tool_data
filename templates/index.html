<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Tool MVP</title>
    <style>
        body {
            display: flex;
            font-family: Arial, sans-serif;
        }
        .sidebar {
            width: 200px;
            background-color: #f1f1f1;
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            overflow-x: hidden;
            padding-top: 20px;
        }
        .sidebar a {
            padding: 10px 16px;
            text-decoration: none;
            font-size: 20px;
            color: black;
            display: block;
        }
        .sidebar a:hover {
            background-color: #555;
            color: white;
        }
        .content {
            margin-left: 220px;
            padding: 20px;
            width: 100%;
        }
        .toggle-button {
            cursor: pointer;
        }
        .folder {
            cursor: pointer;
            background-color: #f1f1f1;
            padding: 10px;
            margin-bottom: 10px;
        }
        .folder-content {
            display: none;
            padding-left: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        table, th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .message {
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .message-header {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .message-body {
            margin-bottom: 10px;
        }
        .message-timestamp {
            font-size: 0.9em;
            color: #999;
        }
        .chart-container {
            width: 80%; /* Adjust as needed */
            margin: auto; /* Center the chart */
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <a href="#ask_data">Ask Data</a>
        <div class="folder" onclick="toggleStoredData()">Stored Data</div>
        <div class="folder-content" id="stored_data">
            <a href="#view_stored_data" onclick="viewStoredData()">View Stored Data</a>
        </div>
        <a href="#predict" onclick="predictData()">Predict</a>
        <a href="#visualize" onclick="visualizeData()">Visualize</a>
        <a href="#messages" onclick="toggleMessages()">Messages</a>
        <div class="folder-content" id="messages_content" style="display: none;">
            <!-- Messages will be displayed dynamically -->
        </div>
        <a href="#profile">Profile</a>
        <a href="#settings">Settings</a>
    </div>

    <!-- Main content -->
    <div class="content">
        <h1>Welcome to the Data Tool MVP</h1>

        <!-- Ask Data Form and Display -->
        <div id="ask_data">
            <form id="dataForm">
                <label for="symbol">Symbol:</label>
                <input type="text" id="symbol" name="symbol">
                <label for="data_type">Data Type:</label>
                <select id="data_type" name="data_type">
                    <option value="TIME_SERIES_DAILY">Daily Time Series</option>
                    <!-- Add other data types as needed -->
                </select>
                <button type="button" onclick="getData()">Get Data</button>
            </form>
            <div id="store_data_form" style="display: none;">
                <h2>Store Data</h2>
                <form id="storeDataForm">
                    <input type="hidden" id="stored_data_input" name="stored_data">
                    <button type="button" onclick="storeData()">Store Data</button>
                </form>
            </div>
            <div id="data_table"></div>
        </div>

        <!-- Stored Data -->
        <div id="stored_data_content" style="margin-top: 20px; display: none;">
            <h2>Stored Data</h2>
            <div id="stored_data_table"></div>
        </div>

        <!-- Predict -->
        <div id="predict" style="display:none;">
            <h2>Predict</h2>
            <div id="prediction_results"></div>
        </div>

        <!-- Visualize -->
        <div id="visualize" style="display:none;">
            <h2>Visualize</h2>
            <div id="visualization_chart"></div>
        </div>

        <!-- Messages -->
        <div id="messages_content" style="display:none;">
            <h2>Messages</h2>
            <!-- Messages will be displayed dynamically -->
        </div>

    </div>

    <script>
        function getData() {
            var symbol = document.getElementById('symbol').value;
            var data_type = document.getElementById('data_type').value;
            
            fetch('/get_data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'symbol=' + encodeURIComponent(symbol) + '&data_type=' + encodeURIComponent(data_type),
            })
            .then(response => response.json())
            .then(data => {
                var tableHtml = '<table><thead><tr><th>Date</th><th>Close Price</th></tr></thead><tbody>';
                data.Date.forEach((date, index) => {
                    tableHtml += '<tr><td>' + date + '</td><td>' + data['Close Price'][index] + '</td></tr>';
                });
                tableHtml += '</tbody></table>';
                document.getElementById('data_table').innerHTML = tableHtml;
                
                // Show store data form
                document.getElementById('store_data_form').style.display = 'block';
                document.getElementById('stored_data_input').value = JSON.stringify(data);
            })
            .catch(error => console.error('Error fetching data:', error));
        }

        function storeData() {
            var storedData = document.getElementById('stored_data_input').value;
            fetch('/store_data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: storedData,
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
            })
            .catch(error => console.error('Error storing data:', error));
        }

        function predictData() {
            // Implement prediction logic
            // Example:
            fetch('/predict', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ x: [1, 2, 3], y: [4, 5, 6] }),  // Replace with actual data
            })
            .then(response => response.json())
            .then(data => {
                var predictionHtml = '<p>Prediction Results:</p><pre>' + JSON.stringify(data, null, 2) + '</pre>';
                document.getElementById('prediction_results').innerHTML = predictionHtml;
                document.getElementById('predict').style.display = 'block';
            })
            .catch(error => console.error('Error predicting data:', error));
        }

        function visualizeData() {
            // Implement visualization logic
            // Example:
            fetch('/predict', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ x: [1, 2, 3], y: [4, 5, 6] }),  // Replace with actual data
            })
            .then(response => response.json())
            .then(data => {
                var x_values = data.map(item => item.x);
                var y_values = data.map(item => item.y);
                var prediction_values = data.map(item => item.prediction);
                
                var trace1 = {
                    x: x_values,
                    y: y_values,
                    mode: 'markers',
                    type: 'scatter',
                    name: 'Actual Data'
                };
                
                var trace2 = {
                    x: x_values,
                    y: prediction_values,
                    mode: 'lines',
                    type: 'scatter',
                    name: 'Prediction'
                };
                
                var layout = {
                    title: 'Data Visualization with Prediction',
                    xaxis: {
                        title: 'X Axis'
                    },
                    yaxis: {
                        title: 'Y Axis'
                    }
                };
                
                var plotData = [trace1, trace2];
                Plotly.newPlot('visualization_chart', plotData, layout);
                document.getElementById('visualize').style.display = 'block';
            })
            .catch(error => console.error('Error visualizing data:', error));
        }

        function toggleStoredData() {
            var storedDataContent = document.getElementById('stored_data_content');
            storedDataContent.style.display = storedDataContent.style.display === 'block' ? 'none' : 'block';
        }

        function viewStoredData() {
            fetch('/get_stored_data')
            .then(response => response.json())
            .then(data => {
                var tableHtml = '<table><thead><tr><th>Date</th><th>Close Price</th></tr></thead><tbody>';
                data.forEach(item => {
                    tableHtml += '<tr><td>' + item.Date + '</td><td>' + item['Close Price'] + '</td></tr>';
                });
                tableHtml += '</tbody></table>';
                document.getElementById('stored_data_table').innerHTML = tableHtml;
                document.getElementById('stored_data_content').style.display = 'block';
            })
            .catch(error => console.error('Error fetching stored data:', error));
        }

        function toggleMessages() {
            var messagesContent = document.getElementById('messages_content');
            messagesContent.style.display = messagesContent.style.display === 'block' ? 'none' : 'block';
        }
    </script>
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</body>
</html>
