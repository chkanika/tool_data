<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>nestt</title>
    <style>
        body {
            display: flex;
            font-family: Arial, sans-serif;
            margin: 0;
            height: 100vh;
        }
        .sidebar {
            width: 200px;
            background-color: #f1f1f1;
            height: 100%;
            position: fixed;
            left: 0;
            top: 0;
            overflow-x: hidden;
            padding-top: 20px;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
        }
        .sidebar a {
            padding: 10px 16px;
            text-decoration: none;
            font-size: 20px;
            color: black;
            display: block;
        }
        .sidebar a:hover {
            background-color: #555;
            color: white;
        }
        .main-content {
            margin-left: 200px;
            width: calc(100% - 200px);
            padding: 20px;
            overflow-y: auto;
        }
        .folder {
            cursor: pointer;
            background-color: #f1f1f1;
            padding: 10px;
            margin-bottom: 10px;
        }
        .folder-content {
            display: none;
            padding-left: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        table, th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .message {
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .message-header {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .message-body {
            margin-bottom: 10px;
        }
        .message-timestamp {
            font-size: 0.9em;
            color: #999;
        }
        .chart-container {
            width: 80%;
            margin: auto;
        }
        #visualization_chart {
            width: 100%;
            height: 500px;
        }
    </style>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar">
        <a href="#ask_data" onclick="showSection('ask_data')">Ask Data</a>
        <div class="folder" onclick="toggleStoredData()">Stored Data</div>
        <div class="folder-content" id="stored_data">
            <a href="#view_stored_data" onclick="viewStoredData()">View Stored Data</a>
        </div>
        <a href="#predict" onclick="showSection('predict')">Predict</a>
        <a href="#visualize" onclick="showSection('visualize')">Visualize</a>
        <a href="#interpret" onclick="showSection('interpret')">Interpret</a>
        <a href="#messages" onclick="toggleMessages()">Messages</a>
        <div class="folder-content" id="messages_content" style="display: none;">
            <!-- Messages will be displayed dynamically -->
        </div>
        <a href="#profile">Profile</a>
        <a href="#settings">Settings</a>
    </div>

    <!-- Main content -->
    <div class="main-content">
        <h1>Welcome to the Data Tool MVP</h1>

        <!-- Ask Data Form and Display -->
        <div id="ask_data">
            <form id="dataForm">
                <label for="symbol">Symbol:</label>
                <input type="text" id="symbol" name="symbol">
                <label for="data_type">Data Type:</label>
                <select id="data_type" name="data_type">
                    <option value="TIME_SERIES_DAILY">Daily Time Series</option>
                    <!-- Add other data types as needed -->
                </select>
                <button type="button" onclick="getData()">Get Data</button>
            </form>
            <div id="store_data_form" style="display: none;">
                <h2>Store Data</h2>
                <form id="storeDataForm">
                    <input type="hidden" id="stored_data_input" name="stored_data">
                    <button type="button" onclick="storeData()">Store Data</button>
                </form>
            </div>
            <div id="data_table"></div>
        </div>

        <!-- Stored Data -->
        <div id="stored_data_content" style="margin-top: 20px; display: none;">
            <h2>Stored Data</h2>
            <div id="stored_data_table"></div>
        </div>

        <!-- Analyze -->
        <div id="analyze" style="display:none;">
            <h2>Analyze Data</h2>
            <div id="analysis_results"></div>
        </div>

        <!-- Predict -->
        <div id="predict" style="display:none;">
            <h2>Predict</h2>
            <div id="prediction_results"></div>
        </div>

        <!-- Visualize -->
        <div id="visualize" style="display:none;">
            <h2>Visualize</h2>
            <div id="visualization_chart"></div>
        </div>

        <!-- Interpret -->
        <div id="interpret" style="display:none;">
            <h2>Interpret Data</h2>
            <textarea id="interpret_input" rows="5" cols="50" placeholder="Enter your data or question here"></textarea>
            <button onclick="interpretData()">Interpret</button>
            <div id="interpretation_result"></div>
        </div>

        <!-- Messages -->
        <div id="messages_content" style="display:none;">
            <h2>Messages</h2>
            <!-- Messages will be displayed dynamically -->
        </div>
    </div>

    <script>
        function getData() {
            var symbol = document.getElementById('symbol').value;
            var data_type = document.getElementById('data_type').value;
            
            fetch('/get_data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: 'symbol=' + encodeURIComponent(symbol) + '&data_type=' + encodeURIComponent(data_type),
            })
            .then(response => response.json())
            .then(data => {
                var tableHtml = '<table><thead><tr><th>Date</th><th>Close Price</th></tr></thead><tbody>';
                data.Date.forEach((date, index) => {
                    tableHtml += '<tr><td>' + date + '</td><td>' + data['Close Price'][index] + '</td></tr>';
                });
                tableHtml += '</tbody></table>';
                document.getElementById('data_table').innerHTML = tableHtml;
                
                // Show store data form
                document.getElementById('store_data_form').style.display = 'block';
                document.getElementById('stored_data_input').value = JSON.stringify(data);
            })
            .catch(error => console.error('Error fetching data:', error));
        }

        function storeData() {
            var storedData = document.getElementById('stored_data_input').value;
            fetch('/store_data', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: storedData,
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message);
            })
            .catch(error => console.error('Error storing data:', error));
        }

        function analyzeData() {
            fetch('/analyze', { method: 'POST' })
                .then(response => response.json())
                .then(analysis => {
                    var analysisHtml = '<p>Analysis Results:</p><pre>' + JSON.stringify(analysis, null, 2) + '</pre>';
                    document.getElementById('analysis_results').innerHTML = analysisHtml;
                    document.getElementById('analyze').style.display = 'block';
                })
                .catch(error => console.error('Error analyzing data:', error));
        }

        function predictData() {
            fetch('/predict', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ x: [1, 2, 3], y: [4, 5, 6] }),  // Replace with actual data
            })
            .then(response => response.json())
            .then(prediction => {
                var predictionHtml = '<p>Prediction Results:</p><pre>' + JSON.stringify(prediction, null, 2) + '</pre>';
                document.getElementById('prediction_results').innerHTML = predictionHtml;
                document.getElementById('predict').style.display = 'block';
            })
            .catch(error => console.error('Error predicting data:', error));
        }

        function visualizeData() {
            fetch('/visualize', { method: 'POST' })
                .then(response => response.json())
                .then(data => {
                    var trace1 = {
                        x: data.x,
                        y: data.y,
                        type: 'scatter'
                    };
                    var layout = {
                        title: 'Data Visualization',
                        xaxis: { title: 'X Axis' },
                        yaxis: { title: 'Y Axis' }
                    };
                    Plotly.newPlot('visualization_chart', [trace1], layout);
                    document.getElementById('visualize').style.display = 'block';
                })
                .catch(error => console.error('Error visualizing data:', error));
        }

        function interpretData() {
            var input = document.getElementById('interpret_input').value;
            fetch('/interpret', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ input: input }),
            })
            .then(response => response.json())
            .then(result => {
                document.getElementById('interpretation_result').innerHTML = '<p>Interpretation:</p><pre>' + JSON.stringify(result, null, 2) + '</pre>';
                document.getElementById('interpret').style.display = 'block';
            })
            .catch(error => console.error('Error interpreting data:', error));
        }

        function showSection(sectionId) {
            document.querySelectorAll('.main-content > div').forEach(div => {
                div.style.display = 'none';
            });
            document.getElementById(sectionId).style.display = 'block';
        }

        function toggleStoredData() {
            var content = document.getElementById('stored_data');
            content.style.display = content.style.display === 'block' ? 'none' : 'block';
        }

        function toggleMessages() {
            var messages = document.getElementById('messages_content');
            messages.style.display = messages.style.display === 'block' ? 'none' : 'block';
        }

        function viewStoredData() {
            fetch('/view_stored_data')
                .then(response => response.json())
                .then(data => {
                    var storedDataHtml = '<table><thead><tr><th>Data</th></tr></thead><tbody>';
                    data.forEach(item => {
                        storedDataHtml += '<tr><td>' + JSON.stringify(item) + '</td></tr>';
                    });
                    storedDataHtml += '</tbody></table>';
                    document.getElementById('stored_data_table').innerHTML = storedDataHtml;
                })
                .catch(error => console.error('Error viewing stored data:', error));
        }
    </script>
</body>
</html>
